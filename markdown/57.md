# Wizardbible #57

***

\-\-\-\- 第0章：目次 \-\-\-

***

- 第1章: Twitterアカウントの自動作成方法                       ねむねむ 著

- 第2章: 初めてのmaltegto                                        黒林檎 著

- 第3章: 基礎機械警備概論                                      IPUSIRON 著

- 第4章: お知らせ

- 第5章: 著者プロフィール



***

\-\-\- 第1章: Twitterアカウントの自動作成方法 \-\-\-

著者：ねむねむ

***


### 0x01 はじめに

　近年、Twitterはインターネットという枠組みを超え社会的にも大きな影響を与
えるまで普及しました。それに伴い、TwitterAPIを用いたユニークなbotやアプリ
ケーション・クライアントが登場しました。一方で、APIを用いたスパムアカウン
トやフォロワー販売業者なども現れました。特にここ数ヶ月、無差別フォローを
行い悪意のあるアプリケーション認証・フィッシングサイトへのリンクをツイー
トする手口が増えています。犯人はこれらの大量のアカウントを自動作成してい
ると考えられます。

　今回は現在のTwitterの仕様に関する問題点・アカウントの大量作成方法を紹介
します。


### 0x02 自動作成の仕組み

　現在、Twitterでは1つのIPアドレスで1日8個程度アカウントを作成することが
可能です。8個程度作成すると新規登録フォームでその旨が表示されて登録できな
くなり、1日程度経つかグローバルIPアドレスを変更すると再び新規登録すること
が可能になります。これら1〜8回の中での1回目、つまり1日の中で初回の新規登
録では画像認証が表示されません。この仕様はほぼすべての国で共通であり1日1
回までなら画像認証無しでアカウントの登録が可能です。今回はこれらの仕様を
用いてアカウントの大量作成を行います。


### 0x03 登録フォームでのPOSTデータの内容

　Twitterの新規アカウント登録フォーム(https://twitter.com/signup)では大ま
かに以下のような内容をPOST送信しています。

\-\-\-\-\-
authenticity_token			ランダムに割り当てられるトークン
user[name]				登録するユーザーのユーザー名
user[email]				登録するユーザーのメールアドレス
user[user_password]			登録するユーザーのパスワード
user[screen_name]			登録するユーザーのscreen_name
user[remember_me_on_signup]		ログイン状態維持の確認
user[use_cookie_personalization]	Webサイトの閲覧をマーケティング使うことに対する許可
asked_cookie_personalization_setting	上記のuser[use_cookie_personalization]を表示したかどうか判断するフラグ変数
context、ad_id、ad_ref			用途不明の変数、常に空文字
user[discoverable_by_email]		メールアドレスからIDを探し出せるようにするかどうかのチェック
user[send_email_newsletter]		メールでTwitterに関する情報を受信するかどうかのチェック
\-\-\-\-\-

　これらのデータに加えて、アクセス時に与えられたCookieも同時に送信する必
要があります。


### 0x04 アカウント自動作成プログラム

　上記のPOST内容を再現するためのプログラムを以下に示します。下記のプログ
ラムを実行するためにはPythonとPython\-Requestsモジュールを導入する必要があ
ります。

\-\-\-\-\-
\# coding:utf\-8
import requests
import re

user_name \= "UserName" \# ユーザー名
screen_name \= "Screen_name" \# screen_name・ユーザーID
password \= "Password" \# パスワード
mailAddress \= "mail@example.com" \# メールアドレス

url \= 'https://twitter.com/signup'

sess \= requests.session()
r \= sess.get(url)
cookie_Session \= r.cookies["_twitter_sess"]
cookie_GuestID \= r.cookies["guest_id"]

html \= r.text
r \= re.compile('<input type\="hidden" value\=".{40}" name\="authenticity_token"/>')
match \= r.search(html)
authKey \= ""
if match:
     authKey \= match.group().strip('<input type\="hidden" value\="')
     authKey \= authKey.strip('" name\="authenticity_token"/>')
else:
     print "NotFound Authenticity_Token"

url \= 'https://twitter.com/account/create'
params \= {}
params['authenticity_token'] \= authKey
params['user[name]'] \= user_name
params['user[email]'] \= mailAddress
params['user[user_password]'] \= password
params['user[screen_name]'] \= screen_name
params['user[remember_me_on_signup]'] \= '1'
params['user[use_cookie_personalization]'] \= '1'
params['asked_cookie_personalization_setting'] \= '1'
params['context'] \= ''
params['ad_id'] \= ''
params['ad_ref'] \= ''
params['user[discoverable_by_email]'] \= '1'
params['user[send_email_newsletter]'] \= '1'
cookie \= {'_twitter_sess' : cookie_Session, 'guest_id' : cookie_GuestID}
r \= sess.post(url,cookies\=cookie, params\=params)
\-\-\-\-\-


### 0x05 大量自動作成を行うには

　1つのIPアドレスで1日1回自動作成が可能であることは確認できましたが、1つ
のIPアドレスに対して1日に1つだけしかアカウントを作成できません。串を用い
れば複数IPアドレスを用意できますが大量自動作成には現実的ではありません。
そこで今回は大量のグローバルIPアドレスを用意するためにAWS\-EC2を用います。
標準設定のEC2ではインスタンスを再起動するごとにグローバルIPアドレスが変更
されます。今回は自動的にインスタンスを再起動するために「EC2APITools」を通
じてインスタンスを操作します。


### 0x06 大量作成プログラムの実行方法

　上記のプログラムにアカウント大量作成機能・メールアドレス認証機能・アプ
リケーション認証機能などを追加しました。
　ソースコードはGitHub(https://github.com/nemumu/mkTwitterAccount)で管理
しています。リンクのリポジトリでは「乱数@example.com」で生成したメールア
ドレスを登録する設定にしています。メールアドレスの取得実装は各自で行う必
要があります。なお、説明の中では「EC2APITools」を利用してインスタンスを操
作する媒体をクライアントとします。

  - クライアント環境：CentOS 6.5
  - インスタンス環境：AmazonLinuxAMI2013.09.2

●クライアント側での準備

　まず、AWSコンソールページのメニューから「Security&Credentials」を選択し、
「PrivateKeyFile」と「X.509Certificate」を取得・ダウンロードしてクライア
ントに保存します。

\-\-\-\-\-
(http://aws.amazon.com/developertools/351)から「EC2APITools」をダウンロードします。
unzip ec2\-api\-tools.zip
yum install \-y java\-1.7.0\-openjdk
vi \~/.bashrc

export JAVA_HOME\="/usr/lib/jvm/jre\-1.7.0\-openjdk.x86_64/"
export EC2_HOME\="[解凍したEC2APIToolsのディレクトリパス]"
export PATH\="${PATH}:${EC2_HOME}/bin"
export EC2_PRIVATE_KEY\="[PrivateKeyFileのパス]"
export EC2_CERT\="[X.509Certificateのパス]"
\# 上記までを追記する

source \~/.bashrc
ec2ver
\-\-\-\-\-

　ここでEC2APIToolsのバージョンが表示されるとEC2APIToolsのインストールは
完了です。

　次にAWSからインスタンスを作成し、秘密鍵をダウンロードしてクライアントに
配置します。

\-\-\-\-\-
ec2\-describe\-instances \-region [インスタンスのリージョン]
\-\-\-\-\-

　インスタンス情報が表示された場合は成功です。なにも表示されない場合はイ
ンスタンスのリージョンを間違えている可能性があります。

●インスタンス側での準備

　次に、ダウンロードした認証鍵を用いてインスタンスにアクセスして設定を行
います。

\-\-\-\-\-
sudo yum update \-y
sudo yum install \-y git
git clone git://github.com/nemumu/mkTwitterAccount.git
\-\-\-\-\-

　「AmazonLinux」では標準でPythonのrequestsモジュールが導入されており、別
途導入する必要はありません。「AmazonLinux」以外の環境で実行する場合はreq
uestsモジュールを導入する必要があります。

●クライアント側でのプログラム実行

　インスタンスからログアウトして停止状態にします。

\-\-\-\-\-
git clone git://github.com/nemumu/mkTwitterAccount.git
cd mkTwitterAccount
vi config.sh \#インスタンス・試行回数の設定をします
./control.sh
\-\-\-\-\-

　config.sh内の変数authURLにWebアプリケーション認証のURLを代入することで、
自動的にアプリケーション認証を行います。このプログラムはインスタンス内で
アカウント作成プログラムを実行し、実行が終了するとインスタンスを再起動さ
せてグローバルIPアドレスを再取得するという流れをループさせることでアカウ
ントの大量作成を可能にしています。

●作成したアカウントのID・パスワードを取得する

\-\-\-\-\-
scp ec2\-user@[インスタンスのIPアドレス]:createout.txt \~/mkTwitterAccount/createout.txt
\-\-\-\-\-

　取得したテキストファイルに作成したアカウントのIDとパスワードが書かれて
います。


### 0x07 どの位アカウントを作成することが可能か

　AWS\-EC2無料枠だと最大で1月750時間分の無料インスタンスが利用可能です。注
意しなければならないのは、1時間以内にインスタンスを再起動した場合でも1時
間分の料金が課金される点です。そのためEC2無料枠で1月に作成可能なアカウン
ト数は最大で750個となります。これを毎月合計12ヶ月継続した場合は750×12\=9
000個程度作成できます。2014年3月時点のマイクロインスタンスの価格で計算す
ると、約2円で1つのTwitterアカウントを作成することが可能です。AWS\-EC2以外
でもグローバルIPアドレスを大量に用意できる環境ならばアカウントの大量作成
が可能です。


### 0x08 さいごに

　アプリケーション認証を行った後、TwitterAPI経由でツイートやフォローを行
うと便利ですが、凍結を防ぐためにフォロー・ツイートを行う時は公式Webサイト
経由で操作する形式の方が安全だと思います。現に、凍結を防ぐ目的で公式Webサ
イトから操作を行っているスパムbotも多く存在します。先ほどのGitHubリポジト
リには公式Webサイト経由でのツイート・フォローなどの操作機能は付属していま
せんが、追加実装は可能です。今回はグローバルIPアドレスを用意するためにEC
2を用いましたが、Session・Cookie管理が可能な環境なら第三者のIPアドレスを
用いて一連の操作を行うことも可能であり、悪意のあるサイトへアクセスしただ
けでその人のIPアドレスでTwitterアカウントを作成し、ツイート・フォローを行
われてしまう危険性があります。倫理観や法律的観点を抜きにしてアカウントの
大量作成という点だけ見るとAWS\-EC2を用いるより他人のIPアドレスを用いてアカ
ウントを作成した方がコスト面・時間単位での作成量共に軍配が上がると思いま
す。もしかすると現在横行しているスパムアカウントはあなたのIPアドレスで作
成・操作されたものかもしれません。上記の様な危険性が考えられるため、部分
的に画像認証を表示しない現在のTwitterの仕様には問題があると思います。



***

\-\-\- 第2章: 初めてのmaltegto \-\-\-

著者：黒林檎

***


### 0x01 はじめに

　今回はソーシャルエンジニアリングっていう分野。 
　ソーシャルエンジニアリングを手助けするツールの説明のが正しい？ 
　最近ソーシャルエンジニアリングって本（[著]クリストファー.ハドナジーさん、
[訳]成田光影さん）買ったんですよ。
　それで色々面白く読ませてもらったんですけどmaltegoが少し気になって使おう
と思ったんですがアホの俺には情報があまりにも少ない。とりあえずWEBで検索し
てもなかなかの過疎度…。 
　専門家が危険危険っていってるの出てきただけで特に何もなかったんです…（泣）。
　もういい俺が調べてWizard Bibleのネタにしてやんよってことでとりあえず頑
張りました。 
　間違った内容ないようにしてるんですが…間違ってたらすいません。
　海外では正規の使い方以外だとソーシャルエンジニアリングとクラッキングの
下調べなんかに使われるみたいです。

>>情報収集やフットプリンティングは、ハッキングの第一歩であるように…（以
下略）。


### 0x02 maltegoってなんでよ!! 

(1)maltegoは視覚的に関係を確認することができる、情報収集ツールです 

  - ドメイン名 
  - Whois情報 
  - DNS名 
  - IPアドレス 
  - など 

(2)maltegoは、情報を列挙することができます。 

  - 人の名前に関連付けられた電子メールアドレス 
  - 人の名前に関連付けられているWebサイト 
  - 人の名前に関連付けられた電話番号 
  - 人の名前に関連付けられている社会集団 
  - 人の名前に関連付けられている企業や組織 

(3)maltegoはまた、次のことができます。 
  - 電子メールアドレスの簡単な検証を行う。 
  - タグとタグがフレーズの場合は、ブログを検索。 
  - ドメインからファイルやメタデータを抽出します。 

…


### 0x03 初めての起動

　maltegoを使う方法は2つ。…3つあるけども。

  - Windowsからの起動
  - Linux(それかMac)からの起動

　BackTrackにはmaltegoが既に入っているので、自前の環境に入れるのがメンド
クサイ方はそちらをご使用ください。 
　筆者はWindows版を利用します。 

　BackTrackでmaltegoを使うならばroot@bt:maltegoで起動します。
　一応BT5r3の仮想環境で試しました。 
　Windowsで利用する場合は、以下のURLからダウンロードできます。

http://www.paterva.com/web6/products/download2.php 

　ついでに無償版と有料版があるらしいです。実行できる機能数や保存できる量
が変わってくるみたいです。 
　ついでに気に入った方は600ドルでライセンス購入すればいいらしいですよ。

　…インストール初めて起動したら英語びっしり…メールアドレスとパスワード
と画像の文字打てっていわれたから打ってたらエラー吐きやがる…。
　よく読んだらアカウント作れって言ってるやん、最近のハッキングツールはな
んでもアカウント作成する時代かよ。とか思いつつアカウント作成します。

https://www.paterva.com/web6/community/maltego/index.php 

　ここで作成、メールアドレスは正規のでお願いね、確認メールくるから。
　名前kuro rinngoでいけたから別になんでもいいっぽい。
　とりま送信、なんかまだアカウント作成画面じゃん。とか思ったらちっさくse
nd mail（だっけ？）とか書いてたからメール確認。
　リンクきてるしクリック。
　んで”Activate your account”って出たからアカウントできたみたい。
　んじゃさっそくmaltegoのログインに戻る。
　んだよ、アカウントがアクティベート出来てないとかふざけんじゃねぇ。って
思いつつメールで送られてきたリンクみたらアカウントの有効化があった。
　とりあえずアカウントがmaltegoコミュニティにログインして使用できます。
ってアラートでたら成功っぽい。 
　んじゃもう出来るだろ、三度目の正直…。
　ログインに成功してしまいました。


### 0x04 初めてのmaltegto 

　先ほど苦難の末、ログインに成功しました。
　起動したらもう簡単ですね。

　まずモード選択、今回はcompany stalkerで行きます。
　ドメインの入力が求められました。
　ターゲットドメインを指定します。そのドメインを元に.pdfや.xmlや.docファ
イルがグラフィックに自動で集まってきます。
　後、maltegoはレイアウトアルゴリズムの4種類をサポートしています。鍵アイ
コンのとなりにあります。 みたとおり、表示を変えれる。グラフィカルな表示を
好まない場合はEntry Listに変えるとよいです。

　例えば、Start a　MachineでfootprintL3（Lever1から3まであるけど、3が無駄
に結果一番多いだけ）を試せば、ネットブロックやASナンバーなどなど色んな情
報も出てきた。 
　どちらかというとAS NmberはLevel1で出てきますが、ApachやPHPといったあれ
ばよいという情報がLevel3で出てきます。

AS Numberとは：http://e\-words.jp/w/ASE795AAE58FB7.html

　後は、試してるときにチェック事項で了承求められたらチェック。

　company stalkerは.pdfなどを抽出することは先ほど触った。

/*
5月訂正
Company Stalkerが仕様変更によりメールアドレスの抽出に変わりました。
使い心地が悪くなってしまいました....(汗)
*/

　しかしmaltegoはドメインからの求める情報だけでなく、TwitterのIDから位置
情報が付加されていれば位置情報や過去につぶやいた内容など一連を抽出しだし
てくれる。

　Twitter関係をmaltegoで行う場合は…。Twitter [＊＊＊＊]です。

　お勧めはgeo location...先ほど述べた位置情報を抽出してくれる機能。俺が対
象に調べたアカウントでは東京新宿と出てきた。自分のアカウントにもスキャン
をあけた結果...何も出てこなかった。これは悪用とかじゃなく自分のアカウント
に対して位置情報を付加さしていないか調べるのに最適だと思った。 

　後はTwitter\-Diggerで対象アカウントについて抽出。後は実名から実在し知り
えるアドレスを調べることが出来る機能がある。
 
　その場合Person\-Email Address。
　これは名前を入力すればそれにあったメールアドレスを探してきてくれる優れ
もの..?
　ついでに俺は適当な名前でやったら三件ヒットしました。

…ざっと触った感じこんな感じ。


### 0x05 実験して思った事 

　.pdfなど自動で集めれるのは良かった。
　特にそれをアップロードしたユーザー？がわかったりしたのか? 

[ドメイン]→[example.pdf]→[黒林檎]...みたいな。

　まぁソーシャルエンジニアリングとか不正アクセスの下調べとかに使われそう
なツールであることは実感出来た。 
　有償版ならさらに素晴らしい情報を手に入れれるのだろう。
　思った事といったら某所をスキャンした結果にやはりPDFをUPした？名前が存在
していた事。しかもこれアカウントでいうところのユーザー名じゃね？って奴。
しかもNONEになってないからまだ実在してんじゃね？って…。
　これはセキュリティ的にどうなの？って思うけどまぁOKなんでしょう。
　それと対となる所をしらべたけどどう考えても捨てアカウントみたいなユーザ
ーで作ってるわ、公開するならひとつのアカウントでまとめてるわ。と綺麗でし
た…（笑） 
　やっぱりこういう所で差が出ちゃうね…。

　…ここまで今年の3月頃の内容でして、v3.0の使用が変更されてPDF(ファイル)
アップロードした列挙機能に変わり、サイト内のメールアドレスを自動収集する
仕組みに変わってしまいました。
　個人的に改悪という形になり、あんな事やこんな妄想」が出来なくなってしま
いました。

　このアップロードで攻撃者的に便利な使い方を紹介するなら。
　サイト内のアドレス自動収集をして。ユーザー名@google.comという形が多いと
思います

/*わかり易いたとえとしてGoogleを使用しました。*/
だいたいユーザー名が大多数だと思うので、maltegoを使用すれば容易にその情報
を取得することが可能です。

…(でも本当この機能よりファイルアップロード列挙のほうがよかった…)

っていうことはログイン認証部分のユーザー名の推測の手間は省けるので残りは
パスワードだけということになりました。

意外にDNSフォレンジックツールといえど攻撃者的にも使用する甲斐がある道具で
あるといえます。

//悪用はしてはいけません。


### 0x06 感想 

　今回はインターネットフォレンジックにあたるだろう分野について書いてみま
した。 
　実際meltegoではまだまだ触れてないことがあるはずだし、このツールはもっと
使いこなしてみたいツールですね。
　Creat a new graphで新規window作るとか、windowクリックしてモード選択画面
にとか事前説明してないけど、不必要だと思いましたの…。
　後はデータのSAVEとか正直UI巣晴らしくわかりやすいから感覚でわかっちゃい
ますよね…。
　maltegoを使用すればあんなことやこんなことが素早くできるので、是非Ollyd
bgみたいに使用しましょう。

/*
maltegoの記事(黒林檎作)をアメーバブログに公開しているので見てください。
＿Maltegoの仕様が変更された??＿
http://ameblo.jp/r00tapple/entry\-11548772727.html
*/

　maltegoなんかは個人を調べる際に使う物ですがインターネットフォレンジック
はサーバーがどのような活動をしてるか調べる事も業務のうちです。
　とか色々笑えないこと言ってますが(矛盾という意味で)
　maltegoはDNSフォレンジックツールの分類です(笑)
　なので、「それちげぇよｗｗ」とか言われるかも知れませんが承知の上!!
　Start a　MachineでfootprintL3なんかがそういう昨日だと思うのですが、もう
Twitterみたりサイト内情報抽出してくれたり…と。
　色々使えるツールになっちゃってます(笑)
　ブログでもmaltegoは随時ネタとして使うつもりなので是非!!

### 0x07 黒林檎のBlogから抜粋おまけ

　Maltegoには…。
　抽出した、メールアドレスを…。
　Google Me !をクリックし検索をかけると…。っていう検索結果を自動で出して
くれる優れた機能がついています(笑)

/*要するにメールアドレス抽出してそのままGoogle検索かけれるって事。*/

＿追記更新6月10日＿
申し訳ないです、Maltegoの仕様変更されましたが、機能自体は使えるもの選択さ
えすれば使用出来るので紹介します。

//これ重要で、デフォルトだとメールアドレスの抽出だけなんだけど、指定すれ
ば前みたいにデータ取れる。

このように右クリック操作で選択させる事で、\->特に指定なければ"ALL***"で行
きましょう。
//結果の変更点がわかりましたか?

アイコン見れば解る通り、フォンナンバー(電話番号)まで取得されてる…。
後…現在地(住所)にメールアドレスに…(恐)。
ついでに、Personを指定すれば人間アイコンとその名前が取得出来たら出ます。
/*ユーザー*/
後は、Rename(名前を変えて自分が解りやすいようにする機能)などなど…。



***

\-\-\- 第3章: 基礎機械警備概論 \-\-\-

著者：IPUSIRON

***


### 0x01 はじめに

　こんばんは、IPUSIRONです。
　最近防犯・警備について学ぶ機会がありましたので、今回のWBの記事では機械
警備について紹介します。

　セキュリティを考える上で、情報セキュリティだけではなく、物理的な攻撃や
ソーシャルエンジニアリングといった別のアプローチによる攻撃に対しても考慮
する必要があります。
　よって、機械警備やホームセキュリティについて知ることはまったくの無駄で
はないと思います。


### 0x02 機械警備とは

　警備業とは、他人から依頼されて請負方式等により警備の業務を行う事業のこ
とです。
　この定義は警備業法という法律で定められています。日本で警備業が行われた
当初は警備業法はありませんでした。しかし、警備員による様々な問題が起きた
ため、現在では警備業法という法律により、様々な規制を受けています。

　警備業法では、業務内容によって、次のように分類されています。

  - 施設警備業務（一号業務）
  - 雑踏警備業務（二号業務）
  - 輸送警備業務（三号業務）
  - 身辺警備業務（四号業務）
  - 機械警備業務

　一号業務〜四号業務の業務内容は名前からも推測できると思いますので、詳細
は省略します。

　機械警備業務は、業務内容として一号業務に含まれますが、一号業務〜四号業
務とは警備形態が大きく異なるため、警備業法では機械警備業務を独立させて扱
っています。
　機械警備業務では、警備業務用機械装置（単純にセンサーや受信機等の機械警
報システムを想像すればよい）を使用して警備業務を行います。本来は法律用語
の「警備業務用機械装置」という用語を使うべきですが、本稿では直観的にわか
りやすいように「機械警備システム」と呼ぶことにします。


### 0x03 機械警備システムの原理

　まず素朴な機械警備システムを考えます。
　玄関に押しボタンスイッチを取り付け、台所や居間まで電線を引っ張り、それ
を電源とベルに接続します。来客が押しボタンスイッチを押下すると、電気が流
れてベルが鳴ります。
　この押しボタンスイッチの代わりに、ドアや窓が開いたときにセンサーが反応
して、異常を知らせるスイッチの役割を果せばよいことになります。

　しかし、この素朴な機械警備システムには大きな問題があります。ネズミによ
って電線をかじられたり、侵入者によって電線を切断されたりすれば、機械警備
システムが無力化してしまいます。

　そこで、機械警備システムでは常に配線をループ構成にしておきます。センサ
ーやスイッチはすべてB接点（スイッチ切り状態では接点が接続しており、スイッ
チ入り状態では接点が接続しない）にしておきます。
　すると、常に電流が流れてしまい、常に電気代が発生しますが、電線の切断等
の問題は解消できます。

　逆に考えると、何らかの方法でループ構成のセンサー部を経由せずに、別のル
ープを作った後に、センサー側を外してしまえば、侵入できてしまうことになり
ます。
　よって、機械警備システムの配線を行う場合は、外部からそのような行為をで
きないように工夫する必要があります。


### 0x04 機械警備システムを構成する機器

　機械警備システムを構成する機器はたくさん存在しますが、今回はその中でも
よく使われる機器や一般の方にも想像しやすい機器を紹介します。

　また、各機器の特徴・施工方法・注意事項等についてもわかりやすい事項のみ
をとりあげます。

●受信機

　機械警備システムを構成するセンサーの状態を管理する機器です。センサーが
反応した場合、受信機が音や光で居住者に知らせたり、遠隔地の監視システムに
発報したりします。一般家庭用のものであれば、火災報知設備やガス漏れ検知設
備と機能を兼ねることもあります。

　受信機という名前ですが、無線等の受信機とはまったく異なります。
　イメージとしては火災報知設備の受信機に近いです。

　受信機の特徴は、次が挙げられます。

  - 火災報知設備の感知器（煙感知器や熱感知器）を接続する場合は、火災報知設
備の配線と同様に送り配線で接続します。
　当然ながら、最後には終端抵抗を取り付けます。
  - ガス漏れ警報器を接続する場合は、検知器側にAC100Vを与える必要があります。
  - 風呂・トイレの異常を知らせる機能がある場合は、機械警備システムとは別回
線で、非常通報スイッチを接続します。
  - 監視できる警戒区域が少ない場合（安価なものは2つぐらい）は、各警戒区域が
どこのセンサーに対応しているかがわかるように対応表を近くに置いておくとよ
い。
　火災報知設備の防災センターにおいて、受信機の脇に警戒区域図をセットで設
置するのと同様の考え方です。
  - 受信機には交流電源が必要です。
　ドアホンの子機等も交流電源が必要なので、受信機の電源回路に対して並列に
接続します。
  - 受動赤外線検知器のように直流電源が必要なものには、2芯より多いAEケーブル
（少なくとも4芯）を用います。
　さらに、場合によっては中継器を経由する必要もあります。

●マグネットスイッチ

　マグネットスイッチ（磁気近接スイッチ）は、窓や扉の開閉を検知するために
使用されます。

　窓や扉に設置する永久磁石部と、戸枠等に設置するリードスイッチ部から構成
されます。
　窓や扉が閉まっているときは、永久磁石部とリードスイッチ部がとても近づい
た状態になっています。このときリードスイッチが永久磁石の磁界によって磁化
され、リードスイッチ内の接点が磁気吸引力で吸引し合い、その結果接点がくっ
つきます。
　一方、窓や扉が開くと、リードスイッチの接点は開放されるので、警戒状態に
ある回路が開回路になり、受信機で警報が鳴ります。

　マグネットスイッチの特徴は、次が挙げられます。

  - 小型。
  - 安価。
  - 電源が不要。
  - 機械的な寿命がとても長い。
  - すべての窓や扉に設置すると、配線工事が大変になります。
  - 鉄製の扉やサッシの窓にそのまま永久磁石部を取り付けると、磁力の低下が生
じる。そのため、鉄扉用のアダプタやスペーサーで浮かせて設定する。
　できれば定期的に磁力のチェックを行うとよい。
  - リードスイッチは繊細であるため、落としたり衝撃を与えない。
　リードスイッチに衝撃等を与えてしまうと、内部のリード管にひびが入ること
があります。
  - 複数のマグネットスイッチを1つの部屋、あるいは建物の周りの窓や出入口に設
置する場合、単線で引き回すようなループ構成にしてはいけません。電波障害や
ノイズの影響により誤動作する可能性が高くなってしまうからです。
　そこで、受信機とマグネットスイッチの間は2芯の電線を用いて、ループ構成を
作ります。

●ガラス破壊検知器

　ガラス破壊検知器は、窓やショーウィンドウ等に直接貼り付けておき、ガラス
の破壊を検知するために使用されます。パッシブセンサーに属します。
　パッシブ（受動）センサーとは他の働きを受けることで動作するセンサーです。
一方、アクティブ（能動）センサーとは自分から働きかけることで動作するセン
サーです。

　マグネットスイッチは窓や扉の枠に取り付けられていますが、ガラス破壊検知
器は一般にガラスの四隅に取り付けられています。ガラス側に取り付けられいる
ため、外からも丸見えであることが多く、抑止効果も期待できます。
　ガラスに加えられる振動には、侵入者による破壊活動によって引き起こされる
振動の他に、強風等によって引き起こされる振動や、拳で叩いたときの振動等が
あります。さらに、環境によっては、交通量の多い道路や鉄道の近く、工場の近
くであれば、それらの振動も考慮する必要があります。また、部屋の内部にある
ベルタイプの電話機やインパクト式のプリンタがあれば、それらにも注意が必要
です。
　こうした中で、確実にガラス破壊であることを検知するためには、単純に振動
を検知するわけにはいきません。
　そこで、ガラス破壊検知器の種類にもよりますが、ガラスが切断されたり割れ
たりするときの高い振動をキャッチするか、ガラスが破壊するときに発生する周
波数を含む音をキャッチします。それらを契機として、回路を遮断します。その
結果ループ回路が切れて、受信機で警報が鳴ります。

　ガラス破壊検知器の特徴は、次が挙げられます。

  - 非接触型（音検知型）のガラス破壊検知器の場合は、超音波を発振するような
機器（例えば、超音波式検知器など）と一緒に取り付けてはなりません。
  - ガラス破壊検知器はガラスのどこに取り付けても作動はしますが、上部の角に
設置することが多いです。
　なぜならば、ガラスの中央に取り付けると、ガラスにケーブルが這うのが見え
てしまい、見栄えが悪いからです。また、下部に取り付けると、靴などで蹴られ
たり、子供などにいたずらされて、破壊されてしまう可能性があります（内部か
らいたずらされることもあります）。
  - 接触型のガラス破壊検知器の場合は、型板ガラスのように凹凸面のうち、検出
素子部分を凸部に当たる位置に取り付けます。これは、検知器への振動の伝搬を
確実にするためです。
  - ガラス破壊検知器を取り付けた後に正常に動作することを検査しますが、その
際にガラスを破壊するわけにはいきません。
　そこで、メーカー製の専用のチェック機器を用いて、動作確認をします。その
ような機器が存在しない場合は、定規を壁に当てて、片方をガラスから離してか
ら、指を離します。すると定規の一端がガラスにぶつかりますが、このときのシ
ョックによりガラス破壊検知器が作動します。また、10円玉や100円玉のような硬
貨でも同様のことができますが、定規を使った方が確実かつ簡単です。

●赤外線遮断検知器

　赤外線遮断検知器は光の直進性を利用した警備用検知器です。パッシブセンサ
ーに属します。
　火災報知設備に馴染みがある方であれば、煙感知器の一種である光電式分離型
感知器を想像してもらえればよいでしょう。

　赤外線遮断検知器は投光器と受光器のペアで使用します。投光器と受光器の間
に（近）赤外線が走っています。投光器と受光器のの間に物体が横切ったりする
ことによって、この光の線が切れることを検知します。
　赤外線は可視光線より波長が長く、肉眼では見えません。つまり、警戒ライン
が見えないため、うまく設置すれば侵入者に気付かれずに、侵入者の存在を検知
することができます。
　また、機器の種類にもよりますが、十数メートルの長い距離を1つの装置で監視
できます。

　自然界には赤外線と近い波長の光線を発する現象があります。また、自動車の
ヘッドライトなどの人口の光源にも同様な波長の赤外線が含まれます。こうした
赤外線と区別するために、赤外線遮断検知器で使用されている赤外線は波形処理
が行われ、パルス波形の赤外線を利用しています。

　赤外線遮断検知器の特徴は、次が挙げられます。

  - 建物の周りの塀の上に設置すると効果的です。これにより、塀を乗り越えてく
る侵入者を検知することができます。
　異なる警戒ラインの投光器・受光器がぴったり隣あっていたりすると、そこを
狙われて侵入されてしまいます。そこで、警戒ラインが交わるように設置するこ
とで死角をなくすことができます。
　ただし、猫や鳥が塀の上にいると発報してしまいます。そこで、投光器・受光
器を取り付けるアームを塀の上部から少し内側に用意して、警戒ラインを塀の上
から少しずらすと有効です。
  - 塀の上に設置面積がない場合、内側に赤外線遮断検知器を取り付けることにな
ります。その際、塀の近くに取り付けてはなりません。なぜならば、侵入者が塀
の上からジャンプをして、赤外線遮断検知器の警戒ラインを超えて侵入できてし
まうからです。そこで、警戒ラインを塀から離します。

●受動赤外線検知器

　赤外線遮断検知器は広がりのある立体の範囲を警戒することができる警備用検
知器です。アクティブセンサーに属します。
　見た目はドーム式で、人体の動作に反応してLEDが点滅している機器です。

　赤外線遮断検知器は近赤外線を用いていましたが、受動赤外線検知器は遠赤外
線を用います。
　絶対零度（\-273℃）より大きい環境下では、すべての物質が原子と分子の振動
  - 回転により赤外線を放射しています。これは人体であっても同様です。
　放射率と呼ばれる値を用いて、受動赤外線検知器は人体を検知します。
　例えば、人体や家具の放射率は0.9以上です。一方、鏡のようによく磨かれた面
の放射率は0に近い値をとります。空気などの期待も放射率が極めて低いです。

　受動赤外線検知器の特徴は、次が挙げられます。

  - 受動赤外線検知器はセンシティブゾーンを横切る方向に感度が高いので、それ
を考慮して設置すると効果的です。
　例えば、玄関で入口方向にセンシティブゾーンを向けて設置するのは望ましく
ありません。入口から入ってきた人体はセンシティブゾーンに入りますが、横切
ったことにならないからです。
　入口の脇に取り付けて、センシティブゾーンを入口に対して垂直になるように
取り付けると有効です。

●非常通報スイッチ

　非常通報スイッチは、危険を感じた人が操作するためのスイッチです。優先ト
イレ等に取り付けら得ている赤いボックスの押しボタンを想像すればよいでしょ
う。
　火災報知設備に馴染みがある方であれば、発信機の警備システム版を想像して
もらえればよいでしょう。

　非常通報スイッチは人が比較的長時間使用する場所、出入口に近場所、侵入者
に追い込まれて逃げ込む場所（パニックルーム）、トイレや風呂場の近くに設置
します。

　非常通報スイッチの特徴は、次が挙げられます。

  - 一度押されたスイッチが簡単に復旧しない構造になっている場合があります。
　これは侵入者による、非常通報スイッチの復旧を防止するためです。簡易的な
ものであれば、押しボタン周りのカバーを取り外せば復旧状態に戻すことができ
ます。ただし、物によっては専用キーがなければ復旧できないものもあります。
  - 非常通報スイッチはスイッチ自体でロックされる構造のものが多い。即ち、押
しボタン式ではなく、受信機側の保持機能に頼っていないということです。つま
り、復旧させるには、受信機の復旧ボタンを押しても意味がなく、非常通報スイ
ッチを復旧状態に戻す必要があるということです。
  - 非常通報スイッチは火災などの非常報知も兼ねる場合は、接点構成がNO状態で
す。ただし、防犯上はNC状態の方が好ましいです。このような場合は、NO/NC両方
の接点が付いた機器を使用するとこの問題を解消できます。
  - コンビニや金融機関では、足で操作する非常通報スイッチが有効です。
　レジから札束を取り出したときに、札束を止めているクリップから信号を発す
る非常通報スイッチもあります。これだと犯人から脅された状態でも操作できる
ために有効です。


### 0x05 最後に

　今回紹介した機械警備システムの機器以外にもたくさんの機器が存在しますの
で、興味がある方は調査してみてください。
　また、火災報知設備と絡めた解説はほとんどできなかったので、次回以降では
その辺りを紹介したいと考えています。

　ではでは。



***

 \-\-\- 第4章: お知らせ \-\-\-

***

- Wizard Bible（http://wizardbible.org/）では随時、執筆ライターを募集して
います。
　扱う内容のテーマは広義での「under ground」です。例えばハッキングやセキ
ュリティからピッキングなどと幅広い内容を考えています。また特殊な職業や趣
味の解説などでも構いません。
　一回きりでも構いません。また必ず毎回連載する義務もありませんので、でき
る範囲で構いません。気軽に声をかけてください。

- Kenji AikoさんがQ&Aを作ってくれました。初めて参加する人でもわかりやすく
書かれていますので、参考にしてください。

http://wizardbible.org/wbQandA.html

- Wizard Bibleに参加希望の方は気軽にメール（ipusiron@gmail.com）ください。


***

  \-\-\-\- 第5章: 著者プロフィール \-\-\-

***


### ねむねむ
●Job: Student
●Web: http://nemumu.com
●Twitter: @nemumupoyo
●Mail: nemumu@nemumu.com
●Comment:
　はじめまして、ねむねむと申します。今回はTwitterの仕様に関する問題点につ
いて執筆しました。今回の執筆を通じて技術的な脆弱性だけでなく、その仕様で
悪用される可能性がないかを意識することも重要だと思いました。今回の記事で
紹介したGitHubリポジトリはプルリク募集中なので遠慮無くマサカリを投げてく
ださい。
　最近は主にネットワーク関連のモジュールを弄っています。その辺のマサカリ
も募集中です。


### 黒林檎
●Job:自宅警備員
●Web: http://profile.ameba.jp/r00tapple/
●Web2:http://packr.tk/
●Twitter: @r00tapple
●Mail: packr@packr.tk


### IPUSIRON
●Job: 自宅警備員予備軍
●Web: http://akademeia.info
●Twitter: @ipusiron
●Mail: ipusiron@gmail.com
●Comment:
　伊豆にある「まぼろし博覧会」にMaDさんと一緒に「ハッカー寺子屋」を制作し
ました。興味がある方は是非ブログを覗いてみてください。

http://usakoro.blogspot.jp/

