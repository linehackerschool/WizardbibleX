# Wizardbible #58

***

## 第0章：目次

***

* 第1章: facebookなりすまし犯人までリバースハッキング     57r4yH0n3yB33 著

* 第2章: 今さら聞けないサムターン回し                          IPUSIRON 著

* 第3章: お知らせ

* 第4章: 著者プロフィール



***

## 第1章: facebookなりすまし犯人までリバースハッキング

著者：57r4yH0n3yB33

***


### 0x01 はじめに

　皆さん、こんにちは。57r4yH0n3yB33です。名前は適当です。
　かつてセキュリティアカデメイアにあったスレッド掲示板では源氏丸と名乗っ
ていました。その節はどうもお世話になりました。

　この度は初めてのWB投稿ですが、簡単な逆ハッキングの成功例をご紹介したい
と思います。


### 0x02 概要

　さて、昨年facebookでなりすましが流行ったのを覚えておりますでしょうか？
　その犯人とふとしたきっかけで出会い、熱い猛アタックを受けました。ラブレ
ターを読んで呼び出されたお家にお邪魔させていただきましたところ、本棚の中
からお名前の書かれた分厚いなりすまし名簿を頂きました。
　近年なりすまし事体が無くなったためそろそろ公開してもよいだろうとWBへの
投稿を踏み切りました。

　ちなみに、そのお家は現在鍵がかかって入れませんので悪しからず。


### 0x03 出会い

　ことの始まりは2013年夏、私のfacebookの友人がなりすましにあったのがきっ
かけでした。そのなりすましは例のごとく友達の友達、つまり私に友達申請を送
ってくださいました。私は喜んで承認いたしましたが、残念ながらメールアドレ
スを教えてくれませんでした。残念に思った私は、彼にコンタクトをとってみま
した。彼からの返事はありませんでした。所詮遊びだったのね…そう諦めました。

　ちなみにfacebookの友人になると通常設定だと友達のメールアドレスが入手で
きるのをご存知ですか？
　現在もほぼ全ての友人のメールアドレスをぶっこぬけます。やり方はyahoo.com
のサイトに行って、メールの連携欄からfacebookと連携するだけです。
　元々facebookは友人のメールアドレスを見ることを制限していません。Google+
などへの移行を検討している人たちへの措置として、Googleにメールアドレスを
直接渡したくないので、Yahooからメールアドレスを取得してくださいとのことで
す。
　私は犯人の目的はそれだと思っております。閑話休題。


### 0x04 突然のラブレター

　何日も何日も経った時、ふと私のPCが不審なパケットを受信しました（図1参照）。

（図1：http://wizardbible.org/58/facebook/photo1.jpg）不審パケット

　Wiresharkで垂れ流しているパケットから、明らかに特権上昇を模索しているこ
とがわかりました。

　例えるなら、エベレストの崖を前に岩の隙間にハーケンを打ち込んでくるよう
な愛おしいパケットを見つけました。私はそれが彼のラブレターとはまったく気
付きませんでした。しかし、せっかく頂いた貴重なメッセージ、読まないわけに
はいきません。
　慎重に該当ポートを閉じ、例えるなら「そのルートだけに雪を流し、こちらで
はないですよ」と教えてあげました（図2参照）。

（図2：http://wizardbible.org/58/facebook/photo2.jpg）ポートを閉じた結果

　彼は再び体制を立て直すべく改めて全てのルートを見直し始めました。私はル
ーターのログをオンにして彼の2回目のアタックを待ちました。
　ほどなくして彼からポートスキャンが行われました（図3参照）。見られている
ということを露とも思わない大胆なアタックでした。連れてきたゾンビたちを総動
員して手当たりしだいドアをガンガンノックする駄目なポートスキャンでした。

（図3：http://wizardbible.org/58/facebook/photo3.jpg）ポートスキャン

　しかも、その中に彼も混じっていました。
　ゾンビの特性を調べている最中に大本営の80番ポートが開いたサーバにアクセ
スしてしまいました。本来ならここからゾンビたちをばっさばっさ切っていき、
ふんずほぐれつの末、運がよければ会話していざご対面という大事なプロセスが
あったはずですが、こともあろうか大将軍自ら先頭に立って「ぬののふく」と「
ひのきのぼう：で私の堅固な玄関をどっかんどっかん叩いているのです。もうこ
うなっては何も魅力を感じません。

　私はインターネットエクスプローラーで彼のWebサイトにアクセスし、家捜しが
始まりました（図4参照）。

（図4：http://wizardbible.org/58/facebook/photo4.jpg）Webサイトの構造


### 0x05 追い込み

　フォルダの最深部には彼の溜めたDBがそのままアップされていました（図5参照）。

（図5：photo5.jpg）DBファイル

　早速sqlを解読してみると、そこにはアドレス、パスワード、苗字、名前、など
のセットがおよそ100万件入っていました（図6参照）。

（図6：http://wizardbible.org/58/facebook/photo6.jpg）DBの中身

　最初それは私にしたことを他の人にもして何らかの方法で回収したリアルデー
タなのかと思いました。しかしよく見ると漢字の名前、カタカナの名前と英語の
名前が一致していないなど結構適当なデータでした。
　調べるとそこにはfacebookでなりすましをされた友人の名前が入っていました。
そのカラムにあるアドレスとパスワードをfacebookのサイトで入力し見ると…こ
のアカウントはロックされています（図7参照）。

（図7：http://wizardbible.org/58/facebook/photo7.jpg）facebookアカウントのロック画面

　少なくとも本当に使われたアカウントであることがわかりました。もう少しカ
ラムを調べていくと…。
　まずはこちらの画像をご覧ください（図8参照）。

（図8：http://wizardbible.org/58/facebook/photo8.jpg）photoカラム

　photoカラムの「C:Dropbox1 CODE DATA AxxxxxxxxxxxxxPHOTO 02245.jp」（一
部、伏字）という文字列を見たときは震えました。
　彼は前世ではきっと名の知れた豪傑だったに違いありません。まさにノーガー
ド戦法でサイバー戦争の引き金を引く命知らずの漢です。
　私は敬意を持って様々な彼のサイトのデータをGoogle先生などに聞いて照合し
たところ、彼の本名ではなく、いわゆるあだ名みたいなものだと分かりました。


### 0x06 その後

　愛宕警察署のサイバー犯罪の担当に電話してこの事件は幕を閉じます。という
か警察もこういったことはあまりよく分からないらしく、正直にいうと現在も放
置されています。
　今も彼の会社のHPにアクセスするとWORKというスタイリッシュなタブの下にSNS
を活用した宣伝広告と書いて元気に仕事しています（笑）。今は別に彼をどうこ
うする気もないし、かばう気もありません。
　彼のような元気な若者が日本の代表として将来変わらずの「ぬののふく」と「
ひのきのぼう」で、黒客やcDc（古いか…）に挑んでいってくれることを期待して
おります。

　読んでいただきありがとうございました。またどこかでお会いしましょう＾＾



***

## 第2章: 今さら聞けないサムターン回し

著者：IPUSIRON

***


### 0x01 はじめに

　サムターン回しは、バイパス解錠の一種です。
　住宅の玄関では、一般的に屋内側にデッドボルトを操作するためのサムターン
があります。新聞受けやドアの隙間から、ドアスコープの穴、ドアの一部を破壊
して上で、シンプルな道具を挿入して、サムターンを回してドアを開錠します。

　サムターンは名称の通り、親指（Thumb＝サム）と人差し指でつまみながら、ひ
ねって操作します。そのため、サムターンは指で操作しやすい形状になっている
ことが多く、サムターン回しで使用する道具でも開けやすいといえます。

　特にドアスコープから行う場合をスコープ解錠と呼ぶ場合もあります。


### 0x02 サムターン回しに狙われる箇所

　ドアの外側から内側にアクセスできる隙間があれば、サムターン回しに利用さ
れる可能性があります。侵入盗によっては強引に穴を開けてしまう場合もありま
す。
　主に次に示した箇所がサムターン回しに狙われやすいです（図1参照）。

①ドアスコープ
②ドアの新聞受け
③ドアの上部の窓
④ドアのガラス
⑤ドアと戸枠の隙間
⑥ドリルで空けた穴

（図1：http://wizardbible.org/58/thumbturn/ThumbTurnAttack1.png）サムターン回しに狙われる箇所


### 0x03 スコープ解錠

　スコープ解錠を行うためには、専用の道具が必要です。
　基本的な形状はL字の金属棒で、先端にはゴムが付いています（図2参照）。こ
のゴムの摩擦力でサムターンを回します。金属棒の直径は、ドアスコープの直径
より小さくなければなりません。

（図2：http://wizardbible.org/58/thumbturn/ThumbTurnAttack2.png）スコープ解錠用の道具

　日本における正規のルートで、スコープ解錠の道具を購入しようとすると数万
円します。購入ルートがない場合や、高くて買えない場合は、自作するという手
もあります。

　それでは、スコープ解錠の手順について説明します。

1：ラジオペンチでドアスコープを外します。
　操作者側に引っ張りながら、回すことで外側のドアスコープが取れます。次に、
内側のスコープはドライバーを穴に挿入し、内側に落とします。

　もしドアスコープが上記の方法で外せない場合は、空転して外側から外せない
タイプか、接着されているかどのどちらかになります。ドアスコープはせいぜい
500円前後なので、ドリルでドアスコープを破壊してしまいましょう。
　もし鍵屋であれば、破壊した後に内側に塞ぎ窓が付いたタイプなどにアップグ
レードを勧めるのはどうでしょうか。当然ながら、ドアスコープのストックがな
い状態で破壊するのは禁物です。

2：ファイバースコープなどで内側の状態を観察します。
　知りたいのはドアスコープからサムターンまでの距離とサムターンの位置関係
です（図3参照）。サムターンの位置関係というのは、ドアノブの下にあるのか、
上にあるのかといったことです。
　日本では、掘込錠であればドアノブの隣、面付錠のであればドアノブの上にサ
ムターンがあることが多いです。

（図3：http://wizardbible.org/58/thumbturn/ThumbTurnAttack3.png）ドアスコープとサムターンの距離の例

　夜間で見にくい場合は照明付きのファイバースコープを用います。

　外側の錠前の様子から錠箱の種類や型番がわかれば、ファイバースコープなど
を用いずともドアスコープからサムターンまでの大体の距離が判断できます。

　もし鍵屋であれば、スコープ解錠の作業中に近くにお客さんがいるはずです。
そのお客さんにいつもドアをどのように開けているのかを聞いて、サムターンの
位置を推測するという手もあります。

3：適切な寸法のサムターン回しの道具を挿入します。

4：先端をサムターンに当てて、ゴムの摩擦でサムターンを回転させます。
　手探り状態で行うため慣れないと難しいかもしれません。先端を回転させると
きに、玄関の周囲のものにぶつからないように注意してください。あまり強くや
るとドアの内側や周囲のものに傷が付く可能性があります。


### 0x04 サムターン回し

　スコープ解錠ではなく、ドアに穴を開けるサムターン回しの手順は次の通りで
す。

1：ドアの内側にあるサムターンの位置と形状を推測します。

　錠前のメーカー、種類（掘込錠か面付錠か）、錠箱の型番、ドアの開き勝手（
左勝手か右勝手か、内開きか外開きか）によって、サムターンの位置と形状が変
わってきます。
　しかし、共通したところもあります。日本ではほとんどの玄関錠がサムターン
はドアノブの上にあります。なぜならばサムターンを操作するときにドアノブが
邪魔にならないためと、サムターンの状態を視認しやすいからです。
　さらに、錠箱において、デッドボルトが飛び出る部分とは逆側に近いところに
サムターンが備わっています。なぜならば、戸枠とドアノブの間にある程度の隙
間がないとドアノブの操作がしにくく、サムターンとドアノブのある水平位置は
揃っていることが多いため、自然とサムターンも戸枠側よりはある程度の隙間を
持つわけです。

　MIWAの掘込錠のGOALの面付錠の例を示します（図4、図5参照）。これはサムタ
ーンのある内側から撮影したものです。

（図4：http://wizardbible.org/58/thumbturn/ThumbTurnAttack4.jpg）MIWAの掘込錠
（図5：http://wizardbible.org/58/thumbturn/ThumbTurnAttack5.jpg）GOALの面付錠

　練習として、これらの錠前における性質や特徴を考察してみてください。
　本番では解錠前に内側の状態は見ることができません。内側を見てサムターン
の位置や形状などについて把握できなければ、当然ながら外側から見ただけで内
側を推測することはほとんど不可能でしょう。

　内側から見た状態で知ることができる特徴は次の通りです。

  * ラッチボルトの向きが内側を向いているので、外開きです。
  * ドアの開く側から見ると、デッドボルトは左側にあり、丁番は右側にあるので、
右勝手になります。
  * サムターンはドアノブの位置より上にあります。
  * デッドボルトが飛び出る部分とは逆側に近いところにサムターンがあります。
　特に、面付錠の方はよりサイドにあります。
  * デッドボルトが出ているため、施錠状態です。
　また、サムターンの向きが横になっていることからも、施錠状態とわかります。
  * MIWA側は薄い平板状のサムターンであり、GOAL側は卵形のつまみのようなサム
ターンです。

　以上で、サムターンの位置と形状がわかりました。

2：サムターンの回転方向を特定します。

　ピッキング時における内筒の回転の特定方法については、すでに言及しました。
　ピッキング時はドアの外側から内筒を回転させますが、サムターン回しではド
アの内側からサムターンを回転させます。そのため、（内側から見た）サムター
ンの回転方向は、（外側から見た）内筒の回転方向と逆方向になります。（外側
から見た）サムターンの回転方向は、（外側から見た）内筒の回転方向と同一方
向になります。

2：サムターンの位置と形状を推測し、回転方向を特定したら、ドアに穴を開ける
箇所を決めます。

　シリンダーになるべく近い方がサムターン回しを簡単にできます。しかし、近
すぎると内側の錠箱にぶつかる可能性があります。そこで、シリンダーの中心か
ら5cm程度離した場所がよいでしょう。
　また、右勝手の場合は右側に穴を開けた方がよいでしょう。なぜならば、右勝
手ではデッドボルトが左側に位置し、穴の位置がデッドボルトとぶつかる可能性
があるからです。

　例えば、先ほどのMIWAのサムターンの場合、シリンダーの横・斜め上・斜め下
のどこに穴を開けてもサムターンを操作できます。
　なぜならば、サムターンの形状が平板状なので、押し下げたり、押し上げたり
して、操作できるからです。

　しかし、GOALのサムターンの場合、シリンダーの横・斜め上・斜め下のどこに
穴を開けても単純な形状のサムターン回しの道具ではサムターンを操作しにくい
です。
　サムターンの形状が卵形で、施錠時はデッドボルト方向を向いています（逆な
らサムターン回しは容易になります）。解錠するためにはサムターンの尖ってい
る部分を（内側から見て）時計回りに90度回転させて、尖っている部分が下を向
くようにします。これらの理由により、サムターン回しがしにくくなっています。
　そこで、サムターン回しの道具の先端の形状を工夫する必要があります。また、
シリンダーの上に穴を開けて、サムターン回しの先端でサムターンを押し下げる
ように操作する必要があります。

3：ドアに穴を開ける場所を決めたら、実際に穴を開けます。

　ドアの種類にもよりますが、頑丈そうなドアであっても内部は空洞になってお
り、ドアの厚みが数mm程度のものもあります。
　電動ドリルでは大きな音がしてしまうため、侵入盗は手動ドリルで穴を開けま
す。鍵屋であっても、夜間であれば、手動ドリルを使う必要があるでしょう。

4：サムターン回しの道具を挿入します。
　サムターン回しの持ち手を操作し、先端の摩擦を利用してサムターンを回転で
きれば、解錠成功です。


### 0x05 サムターン回し対策

　サムターン回しの対策は次の通りです。

  * サムターンの形状を工夫して、サムターン回しの先端がひっかけにくいように
します。例えば、平らな形状より丸い形状の方がサムターン回しに強いといえま
す。
　また、対称形ではない方がサムターンを回しにくいです。
  * サムターンにカバーを付けます。
  * 両面シリンダー錠を採用します。両面シリンダー錠のメリットとしては、サム
ターン回し対策の他に、ベランダから侵入した侵入盗は、再びベランダから出て
いくしかないため、被害が軽減されるという点が挙げられます。集合住宅ではベ
ランダからガラスを破って侵入し、玄関から出ていくという盗難が考えられるの
で、こうしたことを防ぐことができます。
　一方、デメリットもあります。内側の施解錠にも鍵を使用するため、利便性は
落ちます。さらに、内側に施錠することは火災などの緊急時に逃げにくいため、
あまり推奨されません。
  * ドアビューアーを外されないようにします。
  * ガードプレートやゴムパッキン（エアタイトゴム）でドアと戸枠の間に隙間が
できにくいようにします。
　ゴムパッキンの本来の目的は、ドアと戸枠の間に隙間をなくして、防音や気密
を高めることです。
  * 均一の力を与えないと、サムターンが回らない製品があります。



***

## 第3章: お知らせ

***

* Wizard Bible（http://wizardbible.org/）では随時、執筆ライターを募集して
います。
　扱う内容のテーマは広義での「under ground」です。例えばハッキングやセキ
ュリティからピッキングなどと幅広い内容を考えています。また特殊な職業や趣
味の解説などでも構いません。
　一回きりでも構いません。また必ず毎回連載する義務もありませんので、でき
る範囲で構いません。気軽に声をかけてください。

* Kenji AikoさんがQ&Aを作ってくれました。初めて参加する人でもわかりやすく
書かれていますので、参考にしてください。

http://wizardbible.org/wbQandA.html

* Wizard Bibleに参加希望の方は気軽にメール（ipusiron@gmail.com）ください。


***

## 第4章: 著者プロフィール

***


### 57r4yH0n3yB33
●Job: 農家
●Web: None
●Twitter: None
●Mail: trcr8txy@i.softbank.jp
●Comment:
　かつてスレッド型掲示板でお話させていただいた皆さんご無沙汰しております。
業界にいないので最近の事情について話してやってもいいよという方はぜひ色々
教えてください。


### IPUSIRON
●Job: 自宅警備員予備軍
●Web: http://akademeia.info
●Twitter: @ipusiron
●Mail: ipusiron@gmail.com
●Comment:
　バンダイチャンネル、ツタヤディスカス、huluなどに加入していますが、最近
huluで観る動画なくなってきたので、解約するか悩んでいます。
　面白い映画などがありましたら教えてください。
　自分のお勧め動画は「プレッパーズ」です。

